# Image Classification with Multi-labels (Mini Project 2)
B11705051 陳奕廷

專案詳細資訊: [Kaggle 連結](https://www.kaggle.com/competitions/2024-sldl-mini-project-2)
## 專案介紹
此專案延伸自HW3影像分類問題，使用的是多標籤分類方法。資料集包含37866張訓練圖像和8784張待預測圖像。資料集中的標籤數量為79個，每張圖片可能擁有多個標籤，因此需要處理多標籤分類問題，並採用相應的損失函數來計算。

## 資料集
- 訓練資料集：37866張照片
- 測試資料集：8784張照片
- 標籤總數：79個

資料格式為每張圖片對應一個包含標籤的向量，使用 One-Hot 編碼方式，但考慮到多標籤的情況，向量中會有多個1，代表該圖片擁有多個標籤。

## 資料前處理
- **資料增強**：隨機裁剪、翻轉、旋轉等操作來增加數據多樣性。
- **正規化**：將圖像向量正規化，使其適合於模型訓練。
- **標籤處理**：將訓練資料中的標籤轉換為多標籤的形式，並設置為0或1。

訓練資料集被拆分為訓練集和驗證集，驗證集包含1000張圖像，用於檢測mAP是否持續下降，並實現early stop來防止過擬合。

## 模型選擇
選擇使用EfficientNet家族的EfficientNetB4模型進行訓練。選擇B4的原因是，先前使用較小的B0模型訓練後，mAP達到0.59，而B4模型能夠提供更好的性能。修改了分類層以適應79個多標籤的輸出。

## 損失函數與優化器
- **損失函數**：Binary Cross-Entropy (BCE)，並使用Focal Loss來解決類別不平衡問題。
- **優化器**：AdamW優化器，這是Adam的改進版，能更好地處理權重衰減問題。
- **學習率調整**：動態調整學習率，根據模型訓練情況進行自動調整。

## 早期停止
為了防止過擬合，使用了驗證集和early stop策略。每一個epoch結束後，會檢查模型在驗證集上的表現，如果mAP停止上升，則提前停止訓練。

## 訓練結果
- **驗證集結果**：在驗證集上達到0.7028的mAP。
- **Kaggle測試結果**：上傳至Kaggle後，得分約為0.65至0.66，與驗證集結果略有差距。

## 相關參數
批次大小：32
學習率：動態調整
訓練epoch數：大約 10（根據early stop條件進行調整）
